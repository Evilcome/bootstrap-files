nginx:
  image: jwilder/nginx-proxy
  volumes:
    - /var/run/docker.sock:/tmp/docker.sock
    - /var/nginx/certs:/etc/nginx/certs
  ports:
    - "80:80"
    - "443:443"
swifthow:
  build: ./swift-how
  volumes:
    - "swift-how/app:/src/app"
    - /var/nginx/certs:/var/nginx/certs
  environment:
    - VIRTUAL_PROTO=https
    - VIRTUAL_HOST=swift.how
    - VIRTUAL_PORT=8003
    - SSL_KEY_PATH=/var/nginx/certs/swift.how.key
    - SSL_CRT_PATH=/var/nginx/certs/swift.how.crt
  ports:
    - "8003:8003"
blogswifthow:
  image: ghost
  environment:
    - VIRTUAL_HOST=blog.swift.how
    - VIRTUAL_PORT=8004
  ports:
    - "8004:2368"
evilcomecom:
  build: ./evilcome-com
  volumes:
    - "evilcome-com/test-app:/src/app"
  environment:
    - NODE_ENV=production
    - VIRTUAL_HOST=blog.evilcome.com
    - VIRTUAL_PORT=8005
  ports:
    - "8005:8005"
  links:
    - mongo
mongo:
  image: mongo
